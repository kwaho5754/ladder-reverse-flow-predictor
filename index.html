<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>사다리 예측 시스템</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 2rem; }
    h1 { color: #333; }
    .result-block { margin-top: 2rem; background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 0 8px #ccc; }
    .label { font-weight: bold; color: #555; margin-top: 1rem; }
    ul { list-style: none; padding-left: 0; }
    li { margin: 0.5rem 0; }
  </style>
</head>
<body>
  <h1>사다리 예측 시스템</h1>
  <div id="latest-round"></div>

  <div class="result-block" id="three-block">
    <div class="label">3줄 블럭 예측</div>
    <ul id="three-result"></ul>
  </div>

  <div class="result-block" id="four-block">
    <div class="label">4줄 블럭 예측</div>
    <ul id="four-result"></ul>
  </div>

  <div class="result-block" id="final-top3">
    <div class="label">최종 Top3 예측</div>
    <ul id="top3-result"></ul>
  </div>

  <script>
    async function fetchPrediction() {
      const res = await fetch("/predict");
      const data = await res.json();

      document.getElementById("latest-round").innerText = `최근 회차: ${data.latest_round}`;

      const render = (id, result) => {
        const el = document.getElementById(id);
        el.innerHTML = '';
        for (const [key, val] of Object.entries(result)) {
          const li = document.createElement("li");
          li.textContent = `${key} → ${val.top3.join(", ")}`;
          el.appendChild(li);
        }
      };

      render("three-result", data["3줄블럭"]);
      render("four-result", data["4줄블럭"]);

      const top3El = document.getElementById("top3-result");
      top3El.innerHTML = data["최종 Top3"].map(x => `<li>${x}</li>`).join("");
    }

    fetchPrediction();
    setInterval(fetchPrediction, 10000);
  </script>
</body>
</html>
