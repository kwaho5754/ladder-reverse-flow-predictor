<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>사다리 블럭 예측</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2em;
      background-color: #f0f0f0;
    }
    .container {
      background: #fff;
      padding: 2em;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      max-width: 1000px;
      margin: auto;
      text-align: center;
    }
    h1 {
      color: #333;
    }
    .recent-block {
      margin-top: 1em;
      font-size: 1.1em;
      color: #555;
    }
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 1em;
      margin: 1em;
      background: #fafafa;
      flex: 1;
      min-width: 250px;
    }
    .card h3 {
      margin-bottom: 0.5em;
    }
    .divider {
      margin-top: 3em;
      font-size: 1.2em;
      font-weight: bold;
      color: #444;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>📊 사다리 예측 시스템</h1>
    <div id="round">불러오는 중...</div>
    <div class="recent-block" id="recentBlock">최근 블랙: ...</div>
    <div class="cards" id="predictions"></div>

    <div class="divider">🔁 180도 회전 예측 결과</div>
    <div class="cards" id="reversePredictions"></div>

    <div class="divider">🔹 추가 Top3 예측 결과</div>
    <div class="cards" id="extraPredictions"></div>
  </div>

  <script>
    fetch("/predict")
      .then(res => res.json())
      .then(data => {
        document.getElementById("round").innerText = `예측 회차: ${data["예측회차"]}`;
        const recentBlock = data["최근블럭"]?.join(" → ") || "없음";
        document.getElementById("recentBlock").innerText = `최근 블랙: ${recentBlock}`;

        const container = document.getElementById("predictions");
        const reverseContainer = document.getElementById("reversePredictions");
        const extraContainer = document.getElementById("extraPredictions");
        container.innerHTML = "";
        reverseContainer.innerHTML = "";
        extraContainer.innerHTML = "";

        for (const dir in data["Top3"]) {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `<h3>${dir}</h3>`;
          const list = data["Top3"][dir].map(item => `${item.value} (${item.count})`).join("<br>") || "❌ 없음";
          card.innerHTML += `<div>${list}</div>`;

          if (dir.includes("180도")) {
            reverseContainer.appendChild(card);
          } else if (dir.includes("합산") || dir.includes("Top3")) {
            extraContainer.appendChild(card);
          } else {
            container.appendChild(card);
          }
        }
      })
      .catch(err => {
        document.getElementById("recentBlock").innerText = "❌ 블랙 데이터를 불러오지 못했습니다.";
      });
  </script>
</body>
</html>
